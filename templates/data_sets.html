{% extends "layout.html" %}
{% block body %}
  <div
    id="new-data-set-btn"
    style="padding-bottom: 1em;"
    class="ui right floated primary button"
  >
    New Data Set
  </div>
  <table class="ui celled table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for data_set in data_sets %}
        <tr id="data-set-{{ data_set[0] }}">
          <td class="collapsing">{{ data_set[0] }}</td>
          <td>{{ data_set[1] }}</td>
          <td>
            <div class="ui blue label">View</div>
            <div
              onclick="delete_data_set({{ data_set[0] }})"
              class="ui black label"
              style="cursor: pointer;"
            >
              Delete
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <div
    id="new-data-set-modal"
    class="ui modal"
  >
    <div class="header">
      New Data Set
    </div>
    <div class="actions">
      <div class="ui cancel button">
        Cancel
      </div>
      <div class="ui positive button">
        Create
      </div>
    </div>
  </div>
  <script>
    // Open modal on press
    $('#new-data-set-btn')
      .click(function() {
        $('#new-data-set-modal')
          .modal({
            closable: true,
            onApprove: function() {
              window.alert('approved!')
            }
          })
          .modal('show')
      })

    // On delete row
    function delete_data_set(id) {
      $.ajax({
        url: `/data-sets/${id}`,
        type: 'DELETE',
        success: function(data) {
          $(`#data-set-${id}`).remove()
          flash_success('Successfully deleted data set')
        },
        error: function(data) {
          flash_error('Failed to remove data set')
        }
      })
    }
  </script>
{% endblock %}
